# CORS

## CORSëž€?

F/Eì—ì„œ B/E REST APIë¥¼ í†µí•´ í†µì‹ í•˜ëŠ” ê³¼ì •ì—ì„œ,  
ê¼­ í•œë²ˆ ë§ˆì£¼í•˜ëŠ” ë¬¸ì œê°€ ë°”ë¡œ CORSì´ë‹¤.(~~ë¬¼ë¡  ë‚˜ë„ ê·¸ëž¬ë‹¤.~~)

CORSëž€ Cross-Origin Resource Sharingìœ¼ë¡œ ì¶œì²˜ê°€ ë‹¤ë¥¸ ìžì›ë“¤ì„ ê³µìœ í•œë‹¤ëŠ” ì˜ë¯¸ì´ë‹¤.

### ì¶œì²˜...?

ë¨¼ì € ì¶œì²˜(Origin)ëž€ ë¬´ì—‡ì¸ì§€ ë¶€í„° ì•Œì•„ì•¼ í•  ê²ƒì´ë‹¤.

ë³´í†µ ìš°ë¦¬ê°€ ì•Œê³ ìžˆëŠ” URLì—ì„œ Protocol + Host + Port ë¥¼ í•©ì³ Origin ì¦‰ ì¶œì²˜ë¼ê³  í•œë‹¤.  
ì˜ˆë¥¼ë“¤ì–´, `http://localhost:8080/item?id=1&page=1` ì™€ ê°™ì€ í˜•íƒœì˜ URLì´ ìžˆë‹¤ë©´  
http:// (í”„ë¡œí† ì½œ ) + localhost (host) + 8080 (port) ê¹Œì§€ê°€ Originì´ ëœë‹¤.

## SOP

ë¨¼ì € CORSì´ ë°œìƒí•˜ëŠ” ì´ìœ ì¸ SOPì— ëŒ€í•´ ì •ë¦¬í•œë‹¤.  
SOPëž€ Same Origin Policyë¡œ ë‹¨ì–´ ê·¸ëŒ€ë¡œ ë™ì¼ ì¶œì²˜ ì •ì±… ì„ ì˜ë¯¸í•œë‹¤.  
í’€ì–´ì„œ ì„¤ëª…í•˜ë©´, "ë™ì¼í•œ ì¶œì²˜ë¥¼ í†µí•´ì„œë§Œ ë¦¬ì†ŒìŠ¤ë¥¼ ê³µìœ í•  ìˆ˜ ìžˆë‹¤." ë¥¼ ì˜ë¯¸í•œë‹¤.

ì¦‰ ë™ì¼í•œ ì¶œì²˜ë¥¼ í†µí•´ì„œëŠ” ë¦¬ì†ŒìŠ¤ë¥¼ ìžìœ ë¡­ê²Œ ê°€ì ¸ì˜¬ ìˆ˜ ìžˆì§€ë§Œ,  
ë‹¤ë¥¸ ì¶œì²˜ë¥¼ í†µí•´ì„œëŠ” ë¦¬ì†ŒìŠ¤ê°€ ê³µìœ ë  ìˆ˜ ì—†ë‹¤.

SOP ëŠ” ì„œë²„ì—ì„œ ì²˜ë¦¬ë˜ëŠ” ì •ì±…ì´ ì•„ë‹ˆë‹¤.  
ìš”ì²­ì— ëŒ€í•´ ì„œë²„ëŠ” ì •ìƒì ìœ¼ë¡œ ì²˜ë¦¬í•˜ì—¬ ì‘ë‹µí•˜ì˜€ìœ¼ë‚˜,  
ì›¹ ë¸Œë¼ìš°ì €ì—ì„œ ì²˜ë¦¬í•´ì£¼ëŠ” ë³´ì•ˆ ì •ì±…ì´ë‹¤.

(ì‚¬ìš©ìž, ë¸Œë¼ìš°ì €ì—ì„œ ë³´ëŠ”ì¤‘) â†” (FE, localhost:3000) â†”Â ( BE ì„œë²„, localhost:8080)
ìœ„ì™€ ê°™ì€ ìƒí™©ì„ ìƒê°í•´ë³´ìž  
ì‚¬ìš©ìžê°€ ì–´ë–¤ ìš”ì²­ì„ ë³´ë‚´ë©´ FEê°€ í•´ë‹¹ ìš”ì²­ì„ BEë¡œ ë³´ë‚´ ì²˜ë¦¬í•œë‹¤.  
ì´ë•Œ ë°›ì•„ì˜¤ëŠ” ì‘ë‹µ í—¤ë”ì˜ ë‚´ìš©ì—ëŠ”
HostëŠ” BEì¸ localhost:8080ë¡œ ê¸°ë¡ë˜ê³ ,  
Originì€ FE, localhost:3000ìœ¼ë¡œ ê¸°ë¡ë˜ì–´ ìžˆì„ ê²ƒì´ë‹¤.
ë¸Œë¼ìš°ì € ìž…ìž¥ì—ì„œëŠ” ë¦¬ì†ŒìŠ¤ì˜ ì¶œì²˜ì™€ ìš”ì²­ì— ëŒ€í•œ ì¶œì²˜ê°€ ë‹¤ë¥´ê¸° ë•Œë¬¸ì— SOPì— ìœ„ë°°ëœë‹¤ê³  íŒë‹¨í•˜ì—¬,  
ì—ëŸ¬ë¥¼ ë°˜í™˜í•˜ê²Œ ëœë‹¤.

### SOPê°€ í•„ìš”í•œ ì´ìœ ëŠ”?

ì´ëŸ° ë³´ì•ˆ ì •ì±…ì´ í•„ìš”í•œ ì´ìœ ëŠ” ë¬´ì—‡ì¼ê¹Œ?  
ë§Œì•½ SOP ì—†ì´ ì–´í”Œë¦¬ì¼€ì´ì…˜ì´ ìžìœ ë¡­ê²Œ ì†Œí†µí•˜ê²Œ ëœë‹¤ë©´,  
ë‚˜ë„ ëª¨ë¥´ê²Œ ìœ„í—˜í•œ ì½”ë“œì— ëŒ€í•œ ìš”ì²­ì„ ìžë™ìœ¼ë¡œ ìš”ì²­í•˜ê³  ì‘ë‹µ ë°›ì„ ìˆ˜ ìžˆë‹¤.

ë”°ë¼ì„œ ë‹¤ë¥¸ ì¶œì²˜ì—ì„œì˜ ì ‘ê·¼ì„ ë§‰ê¸° ìœ„í•´ SOP ì •ì±…ì´ ë“±ìž¥í–ˆë‹¤.

## í•´ê²°ì±…ìœ¼ë¡œì„œì˜ CORS

í•˜ì§€ë§Œ ê°œë°œí•˜ëŠ” ìƒí™©ì—ì„œ ë‹¤ë¥¸ ì–´í”Œë¦¬ì¼€ì´ì…˜ê³¼ í†µì‹ í•˜ê±°ë‚˜,  
ë‹¤ë¥¸ ì¶œì²˜ì˜ ë¦¬ì†ŒìŠ¤ë¥¼ í•„ìš”ë¡œ í•˜ëŠ” ìƒí™©ì´ ìƒê¸°ê²Œ ëœë‹¤.

ê·¸ë ‡ë‹¤ë©´ ì–´ë–»ê²Œ SOPë¥¼ í•´ê²° í•  ìˆ˜ìžˆëŠ”ê°€ ì— ëŒ€í•œ í•´ê²° ë°©ì•ˆì´ ë°”ë¡œ CORS ì´ë‹¤.  
CORS ì •ì±…ì„ í—ˆìš©í•˜ëŠ” ë¦¬ì†ŒìŠ¤ì— ëŒ€í•´ ë‹¤ë¥¸ ì¶œì²˜ë¼ë„ ì‘ë‹µì„ ë°›ê² ë‹¤ëŠ” ì˜ë¯¸ì´ë‹¤.

ë°±ì—”ë“œ API ì‘ë‹µí—¤ë”ì—, â€˜Access-Control-Allow-Originâ€™ ì†ì„±ì„ í¬í•¨ì‹œí‚¨ë‹¤.  
ì„œë²„ìª½ì—ì„œ ì–´ëŠì–´ëŠ ì¶œì²˜(FE Origin)ë¡œë¶€í„° ìš”ì²­í•œê²ƒì´ë¼ë©´ ê´œì°®ë‹¤ ë¥¼ ì•Œë ¤ì£¼ëŠ” ë°©ì‹ì´ë‹¤.

## Spring Web MVC CORS

ìš°ë¦¬ê°€ ìžì£¼ ì‚¬ìš©í•˜ëŠ” Spring Web MVCì—ì„œ CORSë¥¼ ì ìš©í•˜ëŠ” ë°©ë²•ì— ëª‡ê°€ì§€ê°€ ìžˆë‹¤.

1. HttpServeletResponse ì‚¬ìš©
   ì‘ë‹µ í—¤ë”ì— ì§ì ‘ 'Access-Control-Allow-Origin' ì†ì„±ì„ í¬í•¨ì‹œí‚¤ëŠ” ë°©ë²•ì´ë‹¤.  
   ë‹¤ë§Œ ëª¨ë“  ì‘ë‹µ í—¤ë”ì— ì½”ë“œë¥¼ ì§ì ‘ ì¶”ê°€í•˜ëŠ” ê²ƒì€ ë„ˆë¬´ ë¹„íš¨ìœ¨ ì ì´ë‹¤.

```java
HttpServeletResponse response
...
response.addHeader('Access-Control-Allow-Origin', 'localhost:3000')
// ì™€ì¼ë“œ ì¹´ë“œ * ë¡œ ìž¡ìœ¼ë©´ ëª¨ë“  ìš”ì²­ì— ëŒ€í•´ CORS í—ˆìš©
```

2. @CrossOrigin ì–´ë…¸í…Œì´ì…˜ ì‚¬ìš©  
   CORSì„ ì„¤ì •í•  ëŒ€ìƒì— ì–´ë…¸í…Œì´ì…˜ì„ í™œìš©í•˜ëŠ” ë°©ë²•ì´ë‹¤.

```java
@CrossOrigin(originPatterns = "http://localhost:8080")
@RestController
public class LoginController {
    @GetMapping("/login")
    public String login() {
        return "ë¡œê·¸ì¸ ì„±ê³µ! ID: jayon, PW: 1234";
    }
}
```

í•„ìš”í•œ Controller ì— @CrossOrigin ì–´ë…¸í…Œì´ì…˜ê³¼ ìš”ì²­ì„ í—ˆìš©í•  ì¶œì²˜ë¥¼ í‘œì‹œí•˜ì—¬,
CORS ì²˜ë¦¬ë¥¼ í•  ìˆ˜ ìžˆë‹¤.

3. WebMvcConfigurer ì„¤ì •
   WebMvcConfigurer ì¸í„°íŽ˜ì´ìŠ¤ì— ëŒ€í•œ Spring Beanìœ¼ë¡œ í™˜ê²½ ì„¤ì •í•˜ëŠ” ë°©ë²•ë„ ìžˆë‹¤.  
   @CrossOrigin ë°©ì‹ë„ ê°„ë‹¨í•˜ê¸´ í•˜ì§€ë§Œ, ì—¬ëŸ¬êµ°ë°ì—ì„œ CORS ì²˜ë¦¬ë¥¼ í•˜ë ¤ë©´ ì¤‘ë³µëœ ì½”ë“œê°€ ë§Žì•„ì§„ë‹¤.
   ê¸€ë¡œë²Œ í•˜ê²Œ configíŒŒì¼ë¡œ CORS ì •ì±…ì„ ì„¤ì •í•  ìˆ˜ ìžˆë‹¤.

```java
@Configuration
public class WebConfig implements WebMvcConfigurer {
    @Override
    public void addCorsMappings(CorsRegistry registry) {
        registry.addMapping("/**")
                .allowedOrigins("http://localhost:8080")
                .allowedMethods(HttpMethod.GET.name());
    }
}
```

addMappingsì„ í†µí•´ CORSë¥¼ í—ˆìš©í•  URL pathë¥¼ ì„¤ì •í•˜ê³ ,
allowedOriginsì„ í†µí•´ ë©”ì„œë“œë¥¼ í—ˆìš©í•  ì¶œì²˜ë¥¼ ì„¤ì •í•œë‹¤.
ì¶”ê°€ë¡œ allowedMethodsë¥¼ í†µí•´ CORSë¥¼ í—ˆìš©í•  ë©”ì„œë“œë¥¼ ì œí•œ í•  ìˆ˜ ìžˆë‹¤.

---

> ì°¸ê³ ìžë£Œ  
> <https://escapefromcoding.tistory.com/724>  
> <https://inpa.tistory.com/entry/WEB-ðŸ“š-CORS-ðŸ’¯-ì •ë¦¬-í•´ê²°-ë°©ë²•-ðŸ‘>  
> <https://steady-coding.tistory.com/616>
