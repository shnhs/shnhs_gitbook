# AOP

## 관점

약자를 풀어서 쓰면 Aspect Oriented Programming이다.  
한국어로 말하면 ‘관점 지향 프로그래밍’ 이다.

AOP는 DI와 더불어 Spring의 핵심기능 중 하나이다.

AOP에서 관점(Aspect)이란 프로그램에서 사용되는 특정한 기능을 의미한다.  
어찌보면 이전에 정리한 ‘관심사 분리’에서 관심사와 유사하다고 표현하면 맞을 지 모르겠다.

유사하나 완전히 동일한 것은 아니다. AOP에서는 핵심 기능과 부가적 기능을 분리하여 생각한다.  
예를들어 ‘맛집 예약’ 프로그램의 기능을 생각해보자.  
프로그램 목적에 맞도록 맛집 예약, 회원관리, 예약 관리 와 같은 기능들은 프로그램의 핵심 기능일 것이다.  
그러나 각 핵심기능 마다 로그 쌓기, 회원 보안처리, DB트랜잭션 처리 등 수많은 부가 기능이 필요할 것이다.

AOP에서는 이렇게 프로그램 전반적으로 필요하지만 많은 곳에서 사용되어 흩어지는 부가기능들을  
`관점`이라는 정의를 통해 분리하여 관리하고자 한다.

## IoC, DI

위에서 언급한것 처럼, DI; Dependency Injection; 의존성 주입 은 스프링의 핵심 중 하나이다.

DI에 대해 정리하기 전에 먼저 IoC라는것에 대해서 정리해야 한다.

### IoC; Inversion Of Control

> Hollywood Principle.  
> "Don't call us, we will call you."  
> (배우에게) 우리한테 연락하지마, 우리가 필요하면 널 부를게.

IoC; 제어의 역전은 프레임워크들의 공통된 주요 특징이다.  
프레임워크들은 객체들의 생명주기를 프로그래머가 아닌 프레임워크가 관리하게된다.

> 생명주기간 객체의 생성-설정-초기화-메서드 호출-소멸 과 같은 일련의 과정을 의미한다.

즉 스프링과 같은 프레임 워크들이 우리가 작성한 코드들의 흐름을 제어하게 된다.  
프로그램이 흘러가는 제어권이 코드를 작성한 프로그래머가 아닌 프레임워크가 가지게 되는 것이다.  
이렇게 제어권이 우리 손을 떠나게 되는 것을 제어의 역전 이라고 한다.

### DI

스프링을 기준으로 IoC를 설명하면 스프링 컨테이너 라는 곳에서 모든 객체들의 빈을 관리하고 있다가,  
어떤 객체가 필요할 경우 스프링이 알아서 해당 객체를 필요한 곳에 가져다 주게 된다.

코드를 사용하여 표현한다면 어떤 클래스를 생성하는데에 A라는 객체가 필요할 경우,  
클래스 내부에서 new A() 와 같은 형태로 직접 생성해서 쓰는것이 아니다.

```java
public class MyController(){
    private final SomethingService somethingService;

    @Autowired
    public MyController(SomethingService somethingService) {
        this.somethingService = somethingService;
    }
}
```

위에 코드를 보면 MyController는 somethingService를 내부에서 필요로 한다.  
이를 다르게 표현하면 MyController는 somethingService에 의존하고 있다 라고 할 수 있다.  
이때 MyController에서 somethingService를 new로 생성해서 사용하는 것이 아닌, 생성자를 통해서 외부에서 주입 받았다.  
(여기서 외부는 아마 스프링이 될 것이다.)  
이런 형태로 외부에서 필요한 객체를 주입받아 사용하는 패턴을 의존성 주입(DI)라고 한다.

## 싱글턴 패턴

싱글턴 패턴이란 빈에서 관리하는 객체를 한개로 보장하게 하는 디자인 패턴이다.  
싱글턴 패턴으로 관리할 객체(클래스)의 생성자에 private를 붙여 외부에서 추가로 생성되는 것을 막는다.

싱글톤 패턴은 왜 굳이 사용하는 걸까?  
객체가 초기에 하나 생성되고 그 이후엔 어디에서 해당 객체가 사용되어도 같은 내용을 보장할 수 있다.  
그리고 메모리에 하나만 생성되기 때문에 메모리를 효율적으로 사용할 수 있다.

## Bean과 Bean Factory

정확히는 스프링 빈 이라고 해야 자바빈과 구분되어 지칭할 수 있다.  
IoC를 통해 스프링이 관리하는 객체를 스프링 빈이라고 말한다.

위에서 스프링 프레임워크가 IoC 컨테이너를 통해 객체를 제어하여, 필요한 곳에 의존성 주입을 한다고 했다.  
IoC 컨테이너에서 스프링이 관리하는 객체를 스프링 빈이라고 한다.

IoC 컨테이너에 빈을 등록하기 위해서는 2가지 방법이 있다.

1. @Componant 어노테이션 사용  
   해당 어노테이션을 통해 스프링에게 해당 객체를 IoC컨테이너를 통해 관리하라고 알려준다.  
   스프링은 해당 어노테이션을 자동으로 스캔하여 IoC컨테이너에 등록하여 관리한다.  
   스프링에서는 @Componant 어노테이션을 사용하는 것을 권장한다.

2. @Configuration, @Bean 어노테이션 사용
   해당 어노테이션을 통해 파일에 등록하여 빈을 등록한다.  
   @Configuration 어노테이션이 붙은 객체를 파일에 빈을 등록할 것이니 알아서 조회해라 라는 의미이다.

그리고 위에서 계속 언급한 IoC컨테이너, 즉 등록된 빈을 관리하는 오브젝트?를 BeanFactory라고 한다.
