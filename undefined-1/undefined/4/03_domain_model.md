# Domain Model

## 일단 도메인과 DDD란?

도메인 모델을 이해하기 이전에 일단 도메인과\
도메인을 기준으로 설계하는 아키텍처 패턴인 도메인 주도 설계(DDD; Domain-Driven Design)을 간략하게 이해하자

### 도메인

도메인이란 사전적 의미로 영토, 분야, 영역 등의 의미를 가진다.\
프로그래밍 쪽으로 가져와서 의미를 생각해보면 어떤 기능의 집합? 정도로 생각할 수 있을 것이다.\
어떤 비슷한 영역에 있는 기능들을 하나의 도메인이라고 생각할 수 있다.

### DDD; Domain-Driven Design

도메인 주도 설계(이하 DDD)는 그러면 쉽게 말해서\
프로그램을 도메인 단위로 나누어 설계하는 방식을 의미한다.

'쇼핑몰' 이라는 기능을 가지는 어플리케이션을 만든다고 하면\
주문관련 도메인, 고객관리 도메인, 배송도메인, 결제도메인 등등\
여러 도메인 단위로 나누어 설계 할 수 있다.

## DDD의 Layered Architecture

DDD에서도 이전에 정리한 Layered Architecture 패턴을 적용하여 설계한다. 보통 아래와 같이 4계층으로 분리할 수 있다.

```
UI - Application - Domain - Infra
```

보통 Application 과 Domain을 같이 묶어서 처리하는 3계층 패턴도 많이 사용된다.

### UI Layer

이전에 정리한 Presentation Layer와 동일하다.\
사용자 UI에 관련한 계층이다.

### Application Layer

기능이 정상적으로 동작 할 수 있도록 아래 Domain Model을\
순서 록은 로직에 맞게 호출하는 것을 관심사로 가진다.

Application Layer는 보통 얇게 유지된다.\
도메인에 대한 정보 즉 실제로 어떻게 데이터를 가져와서 처리하는지 에 대한 정보는\
가지고 있지 않고, 실제 데이터의 처리는 도메인 계층에 역할을 넘긴다.

### Domain Layer; Domain Model

실제로 어떤 도메인에 대한 기능을 책임지고 관심사로 하는 계층이다.\
Domain Model이라고도 한다. 어떤 기능에 대해 `어떤 데이터를 입력받고 가져와서 처리하여 응답할지` 에 대한 정보를 가지고 있다.\
즉 Domain 계층에서는 어떤 `행위`를 하는지가 중요하다고 볼 수 있다.

> 실제 기능 동작을 책임지므로\
> Unit Testing 하기에 적합한게 바로 Domain Model이다.

### Infrastructure Layer

DB Layer와 거의 동일하다.\
외부 DB와의 통신 및 데이터 교환을 관심사로 가지는 계층이다.



## Repository

데이터를 불러오는 로직을 담당하는 객체?라고 이해했다.\
어찌보면 앞에서 정리한 DAO와 유사하다고 보면 될 것 같다.

차이점이라면 DAO는 정말 DB관련 데이터 중심,\
Repository는 도메인 모델 중심이다.\
(라고 강의를 통해 적어 놓긴 했는데 사실 명확히 구분하지는 못하겠다. 좀 더 검색이 필요하다.)

## VO

값 자체로 비교할 수 있는 객체를 의미한다.\
내부 속성(필드)가 같다면 같은 객체라고 처리 할 수 있는 경우를 말한다.

위에서 말한 필드가 같으면 같은 객체 라는 처리를 위해서\
VO에서는 Equals 와 HashCode 메서드를 재정의 해야한다.

이 때문에 속성값이 바뀌면 어떤 VO를 아예 다른 객체로 인식되어 처리될 수 있다.\
때문에 VO는 내부에 setter를 가지지 않는 불변 객체여야 한다.

### Equals 와 HashCode

Equals는 쉽게 말해서 두 객체가 동등한지 확인하는 메서드이고,\
HashCode는 실행중인 메모리에서 어떤 객체의 주소값을 반환하는 메서드이다.

보통 VO에서 Equals와 HashCode 메서드를 같이 재정의 하는 이유는\
필드가 같은 VO를 동일하다 라는 처리를 하기 위함이다.

Equals는 기본적으로 두 객체가 다른 주소값을 가지고 있으면 다른 객체다 라고 인식한다.\
그러므로 재정의를 통해 내부 필드의 값의 동등성 비교를 통해 같은 객체 인지를 판단하게 한다.

보통 HashCode도 같이 재정의 되어야 한다.\
기본적으로 HashCode는 메모리 주소값을 통해 해시값을 생성한다고 한다.\
때문에 재정의 하지 않으면 두 객체의 주소값은 다르기 때문에\
같은 객체로 기대하여도 다른 해시값을 가지기 때문에 다르다고 처리될 수 있다.



> 참고자료\
> [Domain Model에 대해서 (umbum.dev)](https://umbum.dev/1203)\
> [https://dev-coco.tistory.com/166](https://dev-coco.tistory.com/166)
